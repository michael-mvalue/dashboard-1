(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[837],{18673:(e,t,r)=>{Promise.resolve().then(r.bind(r,31294))},31280:(e,t,r)=>{"use strict";r.d(t,{u:()=>l});var l=function(e){return e.JOB_INIT="job_init",e.JOB_FETCH_NEW="job_fetch_new",e.JOB_UPDATE="job_update",e.WORKER_INIT="worker_init",e.WORKER_FETCH_NEW="worker_new_fetch",e.WORKER_UPDATE="worker_update",e}({})},31294:(e,t,r)=>{"use strict";r.r(t),r.d(t,{default:()=>S});var l=r(95155),a=r(30832),s=r.n(a),o=r(12115),n=r(64184),i=r(52863),c=r(94161),d=r(75584),u=r(33061),f=r(56201),h=r(15354),b=r(65676),g=r(36115),x=r(41479),m=r(40400),w=r(55753),k=r(59581),p=r(51362),_=r(53999);function j(e){let{value:t}=e,{resolvedTheme:r}=(0,p.D)(),a="dark"===r?"flat":"solid";return(0,l.jsx)("span",{className:"flex justify-center items-center",children:"idle"===t?(0,l.jsx)(k.R,{className:"gap-1 text-white",color:"success",variant:a,children:(0,_.b)(t)}):"busy"===t?(0,l.jsx)(k.R,{className:"gap-1 text-white",color:"danger",variant:"shadow",children:(0,_.b)(t)}):(0,l.jsx)(k.R,{className:"gap-1 text-white",variant:a,children:(0,_.b)(t)})})}var E=r(31280);let v=r(94235).oO.wsBaseURL,y=[{key:10,label:"10"},{key:20,label:"20"},{key:50,label:"50"},{key:100,label:"100"}];function S(){let[e,t]=(0,o.useState)(!0),[r,a]=(0,o.useState)([]),[k,p]=(0,o.useState)(1),[_,S]=(0,o.useState)(0),[F,W]=(0,o.useState)(5),[N,C]=(0,o.useState)({column:"worker_id",direction:"ascending"}),R=(0,o.useRef)(null);(0,o.useEffect)(()=>{let e=new WebSocket("".concat(v,"/worker"));return R.current=e,e.onopen=()=>{console.log("âœ… Worker WebSocket connected"),t(!0),e.send(JSON.stringify({page:k,limit:F}))},e.onmessage=e=>{try{let{type:t,payload:r}=JSON.parse(e.data);if(t===E.u.WORKER_INIT||t===E.u.WORKER_FETCH_NEW){let{data:e,pagination:t}=r;if(!Array.isArray(e))throw console.error("data:: ",e),Error("Invalid job data");a(e),p(t.currentPage),S(t.totalPages)}t===E.u.WORKER_UPDATE&&a(e=>{let t=new Map(e.map(e=>[e.worker_id,e])),l=[];for(let e of r)t.has(e.worker_id)&&l.push(e);return[...e.map(e=>l.find(t=>t.worker_id===e.worker_id)||e)].slice(0,F)})}catch(e){console.error("Failed to parse message",e)}t(!1)},e.onerror=e=>console.error("WebSocket error:",e),e.onclose=()=>console.warn("WebSocket connection closed"),()=>e.close()},[F]);let O=(0,o.useMemo)(()=>{let{column:e,direction:t}=N;return Array.isArray(r)&&null!==r?[...r].sort((r,l)=>{let a=r[e],s=l[e];if(null==a)return"ascending"===t?1:-1;if(null==s)return"ascending"===t?-1:1;let o="string"==typeof a?a.toLowerCase():a,n="string"==typeof s?s.toLowerCase():s;return o<n?"ascending"===t?-1:1:o>n?"ascending"===t?1:-1:0}):[]},[r,N]),I=e=>{W(parseInt(e))};(0,o.useEffect)(()=>{R.current&&R.current.readyState===WebSocket.OPEN&&(t(!0),R.current.send(JSON.stringify({page:k,limit:F})))},[k,F]);let A=(0,o.useCallback)((e,t)=>{switch(t){case"status":return(0,l.jsx)(j,{value:e.status});case"last_heartbeat":return(0,l.jsx)("div",{children:s()(e.last_heartbeat).format("hh:mm:ss A")});default:return(0,n.fm)(e,t)}},[]);return(0,l.jsxs)("div",{className:"flex flex-col gap-4",children:[(0,l.jsx)("h1",{className:(0,w.D)(),children:"Worker"}),(0,l.jsxs)("div",{className:"flex items-center gap-2",children:[(0,l.jsxs)("div",{className:"flex items-center gap-2 min-w-[160px]",children:[(0,l.jsx)("div",{children:"Limit:"}),(0,l.jsx)(i.d,{"aria-label":"Page Size",defaultSelectedKeys:["10"],label:"",onChange:e=>{let{target:{value:t}}=e;return I(t)},children:y.map(e=>(0,l.jsx)(c.y,{children:e.label},e.key))})]}),(0,l.jsx)(d.T,{showControls:!0,initialPage:1,page:k,total:_,onChange:e=>{p(e)}})]}),(0,l.jsxs)(u.j,{"aria-label":"Jobs table",bottomContent:_>0?(0,l.jsx)("div",{className:"flex w-full justify-center",children:(0,l.jsx)(d.T,{isCompact:!0,showControls:!0,showShadow:!0,color:"primary",page:k,total:_,onChange:e=>p(e)})}):null,sortDescriptor:N,onSortChange:C,children:[(0,l.jsxs)(f.X,{children:[(0,l.jsx)(h.e,{allowsSorting:!0,children:"Worker ID"},"worker_id"),(0,l.jsx)(h.e,{allowsSorting:!0,children:"Worker Status"},"status"),(0,l.jsx)(h.e,{allowsSorting:!0,children:"Last Heartbeat"},"last_heartbeat")]}),(0,l.jsx)(b.E,{items:null!=O?O:[],loadingContent:(0,l.jsx)(g.o,{}),loadingState:e?"loading":"idle",children:e=>(0,l.jsx)(x.s,{children:t=>(0,l.jsx)(m.w,{children:A(e,t)})},e.worker_id)})]})]})}},53999:(e,t,r)=>{"use strict";r.d(t,{b:()=>l});let l=e=>e?e.charAt(0).toUpperCase()+e.slice(1):""},55753:(e,t,r)=>{"use strict";r.d(t,{D:()=>a});var l=r(77635);let a=(0,l.tv)({base:"tracking-tight inline font-semibold",variants:{color:{violet:"from-[#FF1CF7] to-[#b249f8]",yellow:"from-[#FF705B] to-[#FFB457]",blue:"from-[#5EA2EF] to-[#0072F5]",cyan:"from-[#00b7fa] to-[#01cfea]",green:"from-[#6FEE8D] to-[#17c964]",pink:"from-[#FF72E1] to-[#F54C7A]",foreground:"dark:from-[#FFFFFF] dark:to-[#4B4B4B]"},size:{xs:"text-base lg:text-lg",sm:"text-3xl lg:text-4xl",md:"text-[2.3rem] lg:text-5xl leading-9",lg:"text-4xl lg:text-6xl"},fullWidth:{true:"w-full block"}},defaultVariants:{size:"md"},compoundVariants:[{color:["violet","yellow","blue","cyan","green","pink","foreground"],class:"bg-clip-text text-transparent bg-gradient-to-b"}]});(0,l.tv)({base:"w-full md:w-1/2 my-2 text-lg lg:text-xl text-default-600 block max-w-full",variants:{fullWidth:{true:"!w-full"}},defaultVariants:{fullWidth:!0}})},94235:(e,t,r)=>{"use strict";r.d(t,{oO:()=>a,CQ:()=>l});let l={name:"PioSolver Dashboard",description:"PioSolver Dashboard",navItems:[{label:"Job",href:"/job"},{label:"Worker",href:"/worker"},{label:"User Input",href:"/input"}],navMenuItems:[{label:"Job",href:"/job"},{label:"Worker",href:"/worker"},{label:"User Input",href:"/input"}],links:{}},a={wsBaseURL:"ws://localhost:9000/ws"}}},e=>{var t=t=>e(e.s=t);e.O(0,[471,894,589,90,441,684,358],()=>t(18673)),_N_E=e.O()}]);